[SICP 学习指南 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/102408596)



[(7 封私信 / 81 条消息) SICP 是不是被高估了？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/30467199/answer/196345759)

# 编程范式

---

​		编程范式是一种方法论，指导编写代码的思路、规则、习惯、定式和常用语。是一种编程模式哲学定式。

​		有的范式只能用于少数特定的语言，有的范式却适用于大多数语言；有的语言可能只支持一种范式，有的语言却可能支持多种范式。

​		C++ 是一种多范式的编程语言。具体来说，现代 C++（11/14 以后）支持“面向过程”“面向对象”“泛型”“模板元”“函数式”这五种主要的编程范式。

> ​		要认识、理解这些范式的优势和劣势，在程序里适当混用，取长补短才是“王道”。
>
> ​		“尽量让周围的人都能看懂代码”，所以常用的范式是“过程 + 对象 + 泛型”，再加上少量的“函数式”，慎用“模板元”。

![img](https://static001.geekbang.org/resource/image/6e/87/6ef13308109b2d1795e43c5206c32687.jpg)





## 面向过程

​		顺序执行的语句、子程序（函数），把任务分解成若干个步骤去执行，最终达成目标。

- 模块化
- 分治
- 基本单元是函数





## 面向对象

​		它的核心思想是“抽象”和“封装”，倡导的是把任务分解成一些高内聚低耦合的对象，这些对象互相通信协作来完成任务。它强调对象之间的关系和接口，而不是完成任务的具体步骤。

​		面向对象范式包括 class、public、private、virtual、this 等类相关的关键字，还有构造函数、析构函数、友元函数等概念。

- 对象化
- 内聚性
- 基本单元是类

​		面向对象通过接口类、抽象类的继承，虚函数的重写来实现。

### 关于继承

​		“面向对象编程”作为一种工程方法，是不可能完美模拟的，纯粹的面向对象也有一些缺陷，其中最明显的就是“继承”。

​		继承的设计初衷是重用代码，表述类型之间的从属关系(is-A)，但它不能与现实的抽象完美的结合，使用的时候会出现很多很别扭的地方，而且会增加逻辑复杂度。使得类的设计变得复杂。

​		在此纸上，基于继承的痛点，各种编程语言都添加了一些补丁。C++的多态、虚函数、重载，解决了继承的一部分问题，但使得逻辑复杂度更加复杂，一定程序上扭曲了面向对象的本意。

​		**在设计类的时候应该尽量少用继承和虚函数。**

> - 完全没有继承关系，就可以让对象不必承受“父辈的重担”（父类成员、虚表等额外开销）
> - 没有隐含的重用代码也会降低耦合度，让类更独立，更容易理解。
> - 把“继承”切割出去之后，可以避免去记忆、实施那一大堆难懂的相关规则
>   - public/protected/private 继承方式的区别、多重继承、纯虚接口类、虚析构函数
>   - 动态转型、对象切片、函数重载等很多危险的陷阱，减少冗余代码，提高代码的健壮性。

​		非要用继承不可，那么我觉得一定要控制继承的层次。如果继承深度超过三层，就说明有点“过度设计”了，需要考虑用组合关系替代继承关系，或者改用模板和泛型。

![img](https://static001.geekbang.org/resource/image/14/d5/145780476bd0beb148e5e130c2336ed5.jpg)



## 基于对象

​		不通过抽象类和接口类来使用对象，而是通过组合具体类，让具体类注册回调的方式来使用。

```c++
class EchoServer
{
public:
	EchoServer()
   {
		server.SetConnectionCallback(s::bind(onConnection));
		server.SetOnMessageCallback(boost::bind(onConnection));
		server.SetOnCloseCallback(boost::bind(onConnection));
   }

	void OnConnection(){...}
	void OnMessage();
	voie OnClose();

	TcpServer server;
}
```



## 泛型编程

​		“一切皆为类型”，或者说是“参数化类型”“类型擦除”，使用模板而不是继承的方式来复用代码，所以运行效率更高，代码也更简洁。

​		泛型的基础就是 template 关键字，然后是庞大而复杂的标准库，里面有各种泛型容器和算法，比如 vector、map、sort，等等。



## 模板元编程

​		核心思想是“类型运算”，操作的数据是编译时可见的“类型”，所以也比较特殊，代码只能由编译器执行，而不能被运行时的 CPU 执行。



## 函数式编程

​		函数式指的是数学意义上、无副作用的函数。也称闭包。

​		核心思想是“一切皆可调用”，通过一系列连续或者嵌套的函数调用实现对数据的处理。

​		 C++11 引入了 Lambda 表达式，它才真正获得了可与其他范式并驾齐驱的地位。